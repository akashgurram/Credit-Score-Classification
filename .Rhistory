exp<-read.csv("creditNA.csv",header=TRUE)
exp$A1=as.factor(exp$A1)
 exp$A4=as.factor(exp$A4)
 exp$A5=as.factor(exp$A5)
 exp$A6=as.factor(exp$A6)
 exp$A7=as.factor(exp$A7)
 exp$A9=as.factor(exp$A9)
 exp$A10=as.factor(exp$A10)
 exp$A12=as.factor(exp$A12)
 exp$A13=as.factor(exp$A13)
 exp$A16=as.factor(exp$A16)
 exp$A3=as.numeric(exp$A3)
 exp$A11=as.numeric(exp$A11)
 exp$A8=as.numeric(exp$A8)
 exp$A14=as.numeric(exp$A14)
 exp$A15=as.numeric(exp$A15)
exp$A2=replace(exp$A2, is.na(exp$A2), mean(exp$A2, na.rm=T))
 exp$A3=replace(exp$A3, is.na(exp$A3), mean(exp$A3, na.rm=T))
 exp$A8=replace(exp$A8, is.na(exp$A8), mean(exp$A8, na.rm=T))
 exp$A11=replace(exp$A11, is.na(exp$A11), mean(exp$A11, na.rm=T))
 exp$A14=replace(exp$A14, is.na(exp$A14), mean(exp$A14, na.rm=T))
 exp$A15=replace(exp$A15, is.na(exp$A15), mean(exp$A15, na.rm=T))
temp<-table(as.vector(exp$A1))
 mod<-names(temp)[temp==max(temp)]
 exp$A1=replace(exp$A1, is.na(exp$A1), mod)
 temp<-table(as.vector(exp$A4))
 mod<-names(temp)[temp==max(temp)]
 exp$A4=replace(exp$A4, is.na(exp$A4), mod)
 temp<-table(as.vector(exp$A5))
 mod<-names(temp)[temp==max(temp)]
 exp$A5=replace(exp$A5, is.na(exp$A5), mod)
 temp<-table(as.vector(exp$A6))
 mod<-names(temp)[temp==max(temp)]
 exp$A6=replace(exp$A6, is.na(exp$A6), mod)
install.packages('e1071', dependencies=TRUE)
 install.packages("caret")
 install.packages("C50")
 require(C50)
set.seed(999)
random<-runif(nrow(exp))
shuffle<-exp[order(random),]
trained<-C5.0(shuffle[1:345,-16],shuffle[1:345,16])
test<-predict(trained,shuffle[346:690,])
require(caret)
confusionMatrix(shuffle[346:690,16],test)
plot(trained)
set.seed(143)
random<-runif(nrow(exp))
shuffle<-exp[order(random),]
trained<-C5.0(shuffle[1:345,-16],shuffle[1:345,16])
test<-predict(trained,shuffle[346:690,])
require(caret)
confusionMatrix(shuffle[346:690,16],test)
utils:::menuInstallPkgs()
utils:::menuInstallPkgs()
q()
q()
